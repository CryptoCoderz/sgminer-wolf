#ifndef WOLF_HAMSI_CL
#define WOLF_HAMSI_CL

// Wolf's implementation of Hamsi, loosely based on that from lib SPH

__constant const uint T512[64][16] = {
	{ 0xef0b0270U, 0x3afd0000U, 0x5dae0000U,
	  0x69490000U, 0x9b0f3c06U, 0x4405b5f9U,
	  0x66140a51U, 0x924f5d0aU, 0xc96b0030U,
	  0xe7250000U, 0x2f840000U, 0x264f0000U,
	  0x08695bf9U, 0x6dfcf137U, 0x509f6984U,
	  0x9e69af68U },
	{ 0xc96b0030U, 0xe7250000U, 0x2f840000U,
	  0x264f0000U, 0x08695bf9U, 0x6dfcf137U,
	  0x509f6984U, 0x9e69af68U, 0x26600240U,
	  0xddd80000U, 0x722a0000U, 0x4f060000U,
	  0x936667ffU, 0x29f944ceU, 0x368b63d5U,
	  0x0c26f262U },
	{ 0x145a3c00U, 0xb9e90000U, 0x61270000U,
	  0xf1610000U, 0xce613d6cU, 0xb0493d78U,
	  0x47a96720U, 0xe18e24c5U, 0x23671400U,
	  0xc8b90000U, 0xf4c70000U, 0xfb750000U,
	  0x73cd2465U, 0xf8a6a549U, 0x02c40a3fU,
	  0xdc24e61fU },
	{ 0x23671400U, 0xc8b90000U, 0xf4c70000U,
	  0xfb750000U, 0x73cd2465U, 0xf8a6a549U,
	  0x02c40a3fU, 0xdc24e61fU, 0x373d2800U,
	  0x71500000U, 0x95e00000U, 0x0a140000U,
	  0xbdac1909U, 0x48ef9831U, 0x456d6d1fU,
	  0x3daac2daU },
	{ 0x54285c00U, 0xeaed0000U, 0xc5d60000U,
	  0xa1c50000U, 0xb3a26770U, 0x94a5c4e1U,
	  0x6bb0419dU, 0x551b3782U, 0x9cbb1800U,
	  0xb0d30000U, 0x92510000U, 0xed930000U,
	  0x593a4345U, 0xe114d5f4U, 0x430633daU,
	  0x78cace29U },
	{ 0x9cbb1800U, 0xb0d30000U, 0x92510000U,
	  0xed930000U, 0x593a4345U, 0xe114d5f4U,
	  0x430633daU, 0x78cace29U, 0xc8934400U,
	  0x5a3e0000U, 0x57870000U, 0x4c560000U,
	  0xea982435U, 0x75b11115U, 0x28b67247U,
	  0x2dd1f9abU },
	{ 0x29449c00U, 0x64e70000U, 0xf24b0000U,
	  0xc2f30000U, 0x0ede4e8fU, 0x56c23745U,
	  0xf3e04259U, 0x8d0d9ec4U, 0x466d0c00U,
	  0x08620000U, 0xdd5d0000U, 0xbadd0000U,
	  0x6a927942U, 0x441f2b93U, 0x218ace6fU,
	  0xbf2c0be2U },
	{ 0x466d0c00U, 0x08620000U, 0xdd5d0000U,
	  0xbadd0000U, 0x6a927942U, 0x441f2b93U,
	  0x218ace6fU, 0xbf2c0be2U, 0x6f299000U,
	  0x6c850000U, 0x2f160000U, 0x782e0000U,
	  0x644c37cdU, 0x12dd1cd6U, 0xd26a8c36U,
	  0x32219526U },
	{ 0xf6800005U, 0x3443c000U, 0x24070000U,
	  0x8f3d0000U, 0x21373bfbU, 0x0ab8d5aeU,
	  0xcdc58b19U, 0xd795ba31U, 0xa67f0001U,
	  0x71378000U, 0x19fc0000U, 0x96db0000U,
	  0x3a8b6dfdU, 0xebcaaef3U, 0x2c6d478fU,
	  0xac8e6c88U },
	{ 0xa67f0001U, 0x71378000U, 0x19fc0000U,
	  0x96db0000U, 0x3a8b6dfdU, 0xebcaaef3U,
	  0x2c6d478fU, 0xac8e6c88U, 0x50ff0004U,
	  0x45744000U, 0x3dfb0000U, 0x19e60000U,
	  0x1bbc5606U, 0xe1727b5dU, 0xe1a8cc96U,
	  0x7b1bd6b9U },
	{ 0xf7750009U, 0xcf3cc000U, 0xc3d60000U,
	  0x04920000U, 0x029519a9U, 0xf8e836baU,
	  0x7a87f14eU, 0x9e16981aU, 0xd46a0000U,
	  0x8dc8c000U, 0xa5af0000U, 0x4a290000U,
	  0xfc4e427aU, 0xc9b4866cU, 0x98369604U,
	  0xf746c320U },
	{ 0xd46a0000U, 0x8dc8c000U, 0xa5af0000U,
	  0x4a290000U, 0xfc4e427aU, 0xc9b4866cU,
	  0x98369604U, 0xf746c320U, 0x231f0009U,
	  0x42f40000U, 0x66790000U, 0x4ebb0000U,
	  0xfedb5bd3U, 0x315cb0d6U, 0xe2b1674aU,
	  0x69505b3aU },
	{ 0x774400f0U, 0xf15a0000U, 0xf5b20000U,
	  0x34140000U, 0x89377e8cU, 0x5a8bec25U,
	  0x0bc3cd1eU, 0xcf3775cbU, 0xf46c0050U,
	  0x96180000U, 0x14a50000U, 0x031f0000U,
	  0x42947eb8U, 0x66bf7e19U, 0x9ca470d2U,
	  0x8a341574U },
	{ 0xf46c0050U, 0x96180000U, 0x14a50000U,
	  0x031f0000U, 0x42947eb8U, 0x66bf7e19U,
	  0x9ca470d2U, 0x8a341574U, 0x832800a0U,
	  0x67420000U, 0xe1170000U, 0x370b0000U,
	  0xcba30034U, 0x3c34923cU, 0x9767bdccU,
	  0x450360bfU },
	{ 0xe8870170U, 0x9d720000U, 0x12db0000U,
	  0xd4220000U, 0xf2886b27U, 0xa921e543U,
	  0x4ef8b518U, 0x618813b1U, 0xb4370060U,
	  0x0c4c0000U, 0x56c20000U, 0x5cae0000U,
	  0x94541f3fU, 0x3b3ef825U, 0x1b365f3dU,
	  0xf3d45758U },
	{ 0xb4370060U, 0x0c4c0000U, 0x56c20000U,
	  0x5cae0000U, 0x94541f3fU, 0x3b3ef825U,
	  0x1b365f3dU, 0xf3d45758U, 0x5cb00110U,
	  0x913e0000U, 0x44190000U, 0x888c0000U,
	  0x66dc7418U, 0x921f1d66U, 0x55ceea25U,
	  0x925c44e9U },
	{ 0x0c720000U, 0x49e50f00U, 0x42790000U,
	  0x5cea0000U, 0x33aa301aU, 0x15822514U,
	  0x95a34b7bU, 0xb44b0090U, 0xfe220000U,
	  0xa7580500U, 0x25d10000U, 0xf7600000U,
	  0x893178daU, 0x1fd4f860U, 0x4ed0a315U,
	  0xa123ff9fU },
	{ 0xfe220000U, 0xa7580500U, 0x25d10000U,
	  0xf7600000U, 0x893178daU, 0x1fd4f860U,
	  0x4ed0a315U, 0xa123ff9fU, 0xf2500000U,
	  0xeebd0a00U, 0x67a80000U, 0xab8a0000U,
	  0xba9b48c0U, 0x0a56dd74U, 0xdb73e86eU,
	  0x1568ff0fU },
	{ 0x45180000U, 0xa5b51700U, 0xf96a0000U,
	  0x3b480000U, 0x1ecc142cU, 0x231395d6U,
	  0x16bca6b0U, 0xdf33f4dfU, 0xb83d0000U,
	  0x16710600U, 0x379a0000U, 0xf5b10000U,
	  0x228161acU, 0xae48f145U, 0x66241616U,
	  0xc5c1eb3eU },
	{ 0xb83d0000U, 0x16710600U, 0x379a0000U,
	  0xf5b10000U, 0x228161acU, 0xae48f145U,
	  0x66241616U, 0xc5c1eb3eU, 0xfd250000U,
	  0xb3c41100U, 0xcef00000U, 0xcef90000U,
	  0x3c4d7580U, 0x8d5b6493U, 0x7098b0a6U,
	  0x1af21fe1U },
	{ 0x75a40000U, 0xc28b2700U, 0x94a40000U,
	  0x90f50000U, 0xfb7857e0U, 0x49ce0baeU,
	  0x1767c483U, 0xaedf667eU, 0xd1660000U,
	  0x1bbc0300U, 0x9eec0000U, 0xf6940000U,
	  0x03024527U, 0xcf70fcf2U, 0xb4431b17U,
	  0x857f3c2bU },
	{ 0xd1660000U, 0x1bbc0300U, 0x9eec0000U,
	  0xf6940000U, 0x03024527U, 0xcf70fcf2U,
	  0xb4431b17U, 0x857f3c2bU, 0xa4c20000U,
	  0xd9372400U, 0x0a480000U, 0x66610000U,
	  0xf87a12c7U, 0x86bef75cU, 0xa324df94U,
	  0x2ba05a55U },
	{ 0x75c90003U, 0x0e10c000U, 0xd1200000U,
	  0xbaea0000U, 0x8bc42f3eU, 0x8758b757U,
	  0xbb28761dU, 0x00b72e2bU, 0xeecf0001U,
	  0x6f564000U, 0xf33e0000U, 0xa79e0000U,
	  0xbdb57219U, 0xb711ebc5U, 0x4a3b40baU,
	  0xfeabf254U },
	{ 0xeecf0001U, 0x6f564000U, 0xf33e0000U,
	  0xa79e0000U, 0xbdb57219U, 0xb711ebc5U,
	  0x4a3b40baU, 0xfeabf254U, 0x9b060002U,
	  0x61468000U, 0x221e0000U, 0x1d740000U,
	  0x36715d27U, 0x30495c92U, 0xf11336a7U,
	  0xfe1cdc7fU },
	{ 0x86790000U, 0x3f390002U, 0xe19ae000U,
	  0x98560000U, 0x9565670eU, 0x4e88c8eaU,
	  0xd3dd4944U, 0x161ddab9U, 0x30b70000U,
	  0xe5d00000U, 0xf4f46000U, 0x42c40000U,
	  0x63b83d6aU, 0x78ba9460U, 0x21afa1eaU,
	  0xb0a51834U },
	{ 0x30b70000U, 0xe5d00000U, 0xf4f46000U,
	  0x42c40000U, 0x63b83d6aU, 0x78ba9460U,
	  0x21afa1eaU, 0xb0a51834U, 0xb6ce0000U,
	  0xdae90002U, 0x156e8000U, 0xda920000U,
	  0xf6dd5a64U, 0x36325c8aU, 0xf272e8aeU,
	  0xa6b8c28dU },
	{ 0x14190000U, 0x23ca003cU, 0x50df0000U,
	  0x44b60000U, 0x1b6c67b0U, 0x3cf3ac75U,
	  0x61e610b0U, 0xdbcadb80U, 0xe3430000U,
	  0x3a4e0014U, 0xf2c60000U, 0xaa4e0000U,
	  0xdb1e42a6U, 0x256bbe15U, 0x123db156U,
	  0x3a4e99d7U },
	{ 0xe3430000U, 0x3a4e0014U, 0xf2c60000U,
	  0xaa4e0000U, 0xdb1e42a6U, 0x256bbe15U,
	  0x123db156U, 0x3a4e99d7U, 0xf75a0000U,
	  0x19840028U, 0xa2190000U, 0xeef80000U,
	  0xc0722516U, 0x19981260U, 0x73dba1e6U,
	  0xe1844257U },
	{ 0x54500000U, 0x0671005cU, 0x25ae0000U,
	  0x6a1e0000U, 0x2ea54edfU, 0x664e8512U,
	  0xbfba18c3U, 0x7e715d17U, 0xbc8d0000U,
	  0xfc3b0018U, 0x19830000U, 0xd10b0000U,
	  0xae1878c4U, 0x42a69856U, 0x0012da37U,
	  0x2c3b504eU },
	{ 0xbc8d0000U, 0xfc3b0018U, 0x19830000U,
	  0xd10b0000U, 0xae1878c4U, 0x42a69856U,
	  0x0012da37U, 0x2c3b504eU, 0xe8dd0000U,
	  0xfa4a0044U, 0x3c2d0000U, 0xbb150000U,
	  0x80bd361bU, 0x24e81d44U, 0xbfa8c2f4U,
	  0x524a0d59U },
	{ 0x69510000U, 0xd4e1009cU, 0xc3230000U,
	  0xac2f0000U, 0xe4950baeU, 0xcea415dcU,
	  0x87ec287cU, 0xbce1a3ceU, 0xc6730000U,
	  0xaf8d000cU, 0xa4c10000U, 0x218d0000U,
	  0x23111587U, 0x7913512fU, 0x1d28ac88U,
	  0x378dd173U },
	{ 0xc6730000U, 0xaf8d000cU, 0xa4c10000U,
	  0x218d0000U, 0x23111587U, 0x7913512fU,
	  0x1d28ac88U, 0x378dd173U, 0xaf220000U,
	  0x7b6c0090U, 0x67e20000U, 0x8da20000U,
	  0xc7841e29U, 0xb7b744f3U, 0x9ac484f4U,
	  0x8b6c72bdU },
	{ 0xcc140000U, 0xa5630000U, 0x5ab90780U,
	  0x3b500000U, 0x4bd013ffU, 0x879b3418U,
	  0x694348c1U, 0xca5a87feU, 0x819e0000U,
	  0xec570000U, 0x66320280U, 0x95f30000U,
	  0x5da92802U, 0x48f43cbcU, 0xe65aa22dU,
	  0x8e67b7faU },
	{ 0x819e0000U, 0xec570000U, 0x66320280U,
	  0x95f30000U, 0x5da92802U, 0x48f43cbcU,
	  0xe65aa22dU, 0x8e67b7faU, 0x4d8a0000U,
	  0x49340000U, 0x3c8b0500U, 0xaea30000U,
	  0x16793bfdU, 0xcf6f08a4U, 0x8f19eaecU,
	  0x443d3004U },
	{ 0x78230000U, 0x12fc0000U, 0xa93a0b80U,
	  0x90a50000U, 0x713e2879U, 0x7ee98924U,
	  0xf08ca062U, 0x636f8babU, 0x02af0000U,
	  0xb7280000U, 0xba1c0300U, 0x56980000U,
	  0xba8d45d3U, 0x8048c667U, 0xa95c149aU,
	  0xf4f6ea7bU },
	{ 0x02af0000U, 0xb7280000U, 0xba1c0300U,
	  0x56980000U, 0xba8d45d3U, 0x8048c667U,
	  0xa95c149aU, 0xf4f6ea7bU, 0x7a8c0000U,
	  0xa5d40000U, 0x13260880U, 0xc63d0000U,
	  0xcbb36daaU, 0xfea14f43U, 0x59d0b4f8U,
	  0x979961d0U },
	{ 0xac480000U, 0x1ba60000U, 0x45fb1380U,
	  0x03430000U, 0x5a85316aU, 0x1fb250b6U,
	  0xfe72c7feU, 0x91e478f6U, 0x1e4e0000U,
	  0xdecf0000U, 0x6df80180U, 0x77240000U,
	  0xec47079eU, 0xf4a0694eU, 0xcda31812U,
	  0x98aa496eU },
	{ 0x1e4e0000U, 0xdecf0000U, 0x6df80180U,
	  0x77240000U, 0xec47079eU, 0xf4a0694eU,
	  0xcda31812U, 0x98aa496eU, 0xb2060000U,
	  0xc5690000U, 0x28031200U, 0x74670000U,
	  0xb6c236f4U, 0xeb1239f8U, 0x33d1dfecU,
	  0x094e3198U },
	{ 0xaec30000U, 0x9c4f0001U, 0x79d1e000U,
	  0x2c150000U, 0x45cc75b3U, 0x6650b736U,
	  0xab92f78fU, 0xa312567bU, 0xdb250000U,
	  0x09290000U, 0x49aac000U, 0x81e10000U,
	  0xcafe6b59U, 0x42793431U, 0x43566b76U,
	  0xe86cba2eU },
	{ 0xdb250000U, 0x09290000U, 0x49aac000U,
	  0x81e10000U, 0xcafe6b59U, 0x42793431U,
	  0x43566b76U, 0xe86cba2eU, 0x75e60000U,
	  0x95660001U, 0x307b2000U, 0xadf40000U,
	  0x8f321eeaU, 0x24298307U, 0xe8c49cf9U,
	  0x4b7eec55U },
	{ 0x58430000U, 0x807e0000U, 0x78330001U,
	  0xc66b3800U, 0xe7375cdcU, 0x79ad3fddU,
	  0xac73fe6fU, 0x3a4479b1U, 0x1d5a0000U,
	  0x2b720000U, 0x488d0000U, 0xaf611800U,
	  0x25cb2ec5U, 0xc879bfd0U, 0x81a20429U,
	  0x1e7536a6U },
	{ 0x1d5a0000U, 0x2b720000U, 0x488d0000U,
	  0xaf611800U, 0x25cb2ec5U, 0xc879bfd0U,
	  0x81a20429U, 0x1e7536a6U, 0x45190000U,
	  0xab0c0000U, 0x30be0001U, 0x690a2000U,
	  0xc2fc7219U, 0xb1d4800dU, 0x2dd1fa46U,
	  0x24314f17U },
	{ 0xa53b0000U, 0x14260000U, 0x4e30001eU,
	  0x7cae0000U, 0x8f9e0dd5U, 0x78dfaa3dU,
	  0xf73168d8U, 0x0b1b4946U, 0x07ed0000U,
	  0xb2500000U, 0x8774000aU, 0x970d0000U,
	  0x437223aeU, 0x48c76ea4U, 0xf4786222U,
	  0x9075b1ceU },
	{ 0x07ed0000U, 0xb2500000U, 0x8774000aU,
	  0x970d0000U, 0x437223aeU, 0x48c76ea4U,
	  0xf4786222U, 0x9075b1ceU, 0xa2d60000U,
	  0xa6760000U, 0xc9440014U, 0xeba30000U,
	  0xccec2e7bU, 0x3018c499U, 0x03490afaU,
	  0x9b6ef888U },
	{ 0x88980000U, 0x1f940000U, 0x7fcf002eU,
	  0xfb4e0000U, 0xf158079aU, 0x61ae9167U,
	  0xa895706cU, 0xe6107494U, 0x0bc20000U,
	  0xdb630000U, 0x7e88000cU, 0x15860000U,
	  0x91fd48f3U, 0x7581bb43U, 0xf460449eU,
	  0xd8b61463U },
	{ 0x0bc20000U, 0xdb630000U, 0x7e88000cU,
	  0x15860000U, 0x91fd48f3U, 0x7581bb43U,
	  0xf460449eU, 0xd8b61463U, 0x835a0000U,
	  0xc4f70000U, 0x01470022U, 0xeec80000U,
	  0x60a54f69U, 0x142f2a24U, 0x5cf534f2U,
	  0x3ea660f7U },
	{ 0x52500000U, 0x29540000U, 0x6a61004eU,
	  0xf0ff0000U, 0x9a317eecU, 0x452341ceU,
	  0xcf568fe5U, 0x5303130fU, 0x538d0000U,
	  0xa9fc0000U, 0x9ef70006U, 0x56ff0000U,
	  0x0ae4004eU, 0x92c5cdf9U, 0xa9444018U,
	  0x7f975691U },
	{ 0x538d0000U, 0xa9fc0000U, 0x9ef70006U,
	  0x56ff0000U, 0x0ae4004eU, 0x92c5cdf9U,
	  0xa9444018U, 0x7f975691U, 0x01dd0000U,
	  0x80a80000U, 0xf4960048U, 0xa6000000U,
	  0x90d57ea2U, 0xd7e68c37U, 0x6612cffdU,
	  0x2c94459eU },
	{ 0xe6280000U, 0x4c4b0000U, 0xa8550000U,
	  0xd3d002e0U, 0xd86130b8U, 0x98a7b0daU,
	  0x289506b4U, 0xd75a4897U, 0xf0c50000U,
	  0x59230000U, 0x45820000U, 0xe18d00c0U,
	  0x3b6d0631U, 0xc2ed5699U, 0xcbe0fe1cU,
	  0x56a7b19fU },
	{ 0xf0c50000U, 0x59230000U, 0x45820000U,
	  0xe18d00c0U, 0x3b6d0631U, 0xc2ed5699U,
	  0xcbe0fe1cU, 0x56a7b19fU, 0x16ed0000U,
	  0x15680000U, 0xedd70000U, 0x325d0220U,
	  0xe30c3689U, 0x5a4ae643U, 0xe375f8a8U,
	  0x81fdf908U },
	{ 0xb4310000U, 0x77330000U, 0xb15d0000U,
	  0x7fd004e0U, 0x78a26138U, 0xd116c35dU,
	  0xd256d489U, 0x4e6f74deU, 0xe3060000U,
	  0xbdc10000U, 0x87130000U, 0xbff20060U,
	  0x2eba0a1aU, 0x8db53751U, 0x73c5ab06U,
	  0x5bd61539U },
	{ 0xe3060000U, 0xbdc10000U, 0x87130000U,
	  0xbff20060U, 0x2eba0a1aU, 0x8db53751U,
	  0x73c5ab06U, 0x5bd61539U, 0x57370000U,
	  0xcaf20000U, 0x364e0000U, 0xc0220480U,
	  0x56186b22U, 0x5ca3f40cU, 0xa1937f8fU,
	  0x15b961e7U },
	{ 0x02f20000U, 0xa2810000U, 0x873f0000U,
	  0xe36c7800U, 0x1e1d74efU, 0x073d2bd6U,
	  0xc4c23237U, 0x7f32259eU, 0xbadd0000U,
	  0x13ad0000U, 0xb7e70000U, 0xf7282800U,
	  0xdf45144dU, 0x361ac33aU, 0xea5a8d14U,
	  0x2a2c18f0U },
	{ 0xbadd0000U, 0x13ad0000U, 0xb7e70000U,
	  0xf7282800U, 0xdf45144dU, 0x361ac33aU,
	  0xea5a8d14U, 0x2a2c18f0U, 0xb82f0000U,
	  0xb12c0000U, 0x30d80000U, 0x14445000U,
	  0xc15860a2U, 0x3127e8ecU, 0x2e98bf23U,
	  0x551e3d6eU },
	{ 0x1e6c0000U, 0xc4420000U, 0x8a2e0000U,
	  0xbcb6b800U, 0x2c4413b6U, 0x8bfdd3daU,
	  0x6a0c1bc8U, 0xb99dc2ebU, 0x92560000U,
	  0x1eda0000U, 0xea510000U, 0xe8b13000U,
	  0xa93556a5U, 0xebfb6199U, 0xb15c2254U,
	  0x33c5244fU },
	{ 0x92560000U, 0x1eda0000U, 0xea510000U,
	  0xe8b13000U, 0xa93556a5U, 0xebfb6199U,
	  0xb15c2254U, 0x33c5244fU, 0x8c3a0000U,
	  0xda980000U, 0x607f0000U, 0x54078800U,
	  0x85714513U, 0x6006b243U, 0xdb50399cU,
	  0x8a58e6a4U },
	{ 0x033d0000U, 0x08b30000U, 0xf33a0000U,
	  0x3ac20007U, 0x51298a50U, 0x6b6e661fU,
	  0x0ea5cfe3U, 0xe6da7ffeU, 0xa8da0000U,
	  0x96be0000U, 0x5c1d0000U, 0x07da0002U,
	  0x7d669583U, 0x1f98708aU, 0xbb668808U,
	  0xda878000U },
	{ 0xa8da0000U, 0x96be0000U, 0x5c1d0000U,
	  0x07da0002U, 0x7d669583U, 0x1f98708aU,
	  0xbb668808U, 0xda878000U, 0xabe70000U,
	  0x9e0d0000U, 0xaf270000U, 0x3d180005U,
	  0x2c4f1fd3U, 0x74f61695U, 0xb5c347ebU,
	  0x3c5dfffeU },
	{ 0x01930000U, 0xe7820000U, 0xedfb0000U,
	  0xcf0c000bU, 0x8dd08d58U, 0xbca3b42eU,
	  0x063661e1U, 0x536f9e7bU, 0x92280000U,
	  0xdc850000U, 0x57fa0000U, 0x56dc0003U,
	  0xbae92316U, 0x5aefa30cU, 0x90cef752U,
	  0x7b1675d7U },
	{ 0x92280000U, 0xdc850000U, 0x57fa0000U,
	  0x56dc0003U, 0xbae92316U, 0x5aefa30cU,
	  0x90cef752U, 0x7b1675d7U, 0x93bb0000U,
	  0x3b070000U, 0xba010000U, 0x99d00008U,
	  0x3739ae4eU, 0xe64c1722U, 0x96f896b3U,
	  0x2879ebacU },
	{ 0x5fa80000U, 0x56030000U, 0x43ae0000U,
	  0x64f30013U, 0x257e86bfU, 0x1311944eU,
	  0x541e95bfU, 0x8ea4db69U, 0x00440000U,
	  0x7f480000U, 0xda7c0000U, 0x2a230001U,
	  0x3badc9ccU, 0xa9b69c87U, 0x030a9e60U,
	  0xbe0a679eU },
	{ 0x00440000U, 0x7f480000U, 0xda7c0000U,
	  0x2a230001U, 0x3badc9ccU, 0xa9b69c87U,
	  0x030a9e60U, 0xbe0a679eU, 0x5fec0000U,
	  0x294b0000U, 0x99d20000U, 0x4ed00012U,
	  0x1ed34f73U, 0xbaa708c9U, 0x57140bdfU,
	  0x30aebcf7U },
	{ 0xee930000U, 0xd6070000U, 0x92c10000U,
	  0x2b9801e0U, 0x9451287cU, 0x3b6cfb57U,
	  0x45312374U, 0x201f6a64U, 0x7b280000U,
	  0x57420000U, 0xa9e50000U, 0x634300a0U,
	  0x9edb442fU, 0x6d9995bbU, 0x27f83b03U,
	  0xc7ff60f0U },
	{ 0x7b280000U, 0x57420000U, 0xa9e50000U,
	  0x634300a0U, 0x9edb442fU, 0x6d9995bbU,
	  0x27f83b03U, 0xc7ff60f0U, 0x95bb0000U,
	  0x81450000U, 0x3b240000U, 0x48db0140U,
	  0x0a8a6c53U, 0x56f56eecU, 0x62c91877U,
	  0xe7e00a94U }
};

__constant static const uint HAMSI_IV512[] = {
	0x73746565U, 0x6c706172U, 0x6b204172U,
	0x656e6265U, 0x72672031U, 0x302c2062U,
	0x75732032U, 0x3434362cU, 0x20422d33U,
	0x30303120U, 0x4c657576U, 0x656e2d48U,
	0x65766572U, 0x6c65652cU, 0x2042656cU,
	0x6769756dU
};

__constant static const uint alpha_n[] = {
	0xff00f0f0U, 0xccccaaaaU, 0xf0f0ccccU,
	0xff00aaaaU, 0xccccaaaaU, 0xf0f0ff00U,
	0xaaaaccccU, 0xf0f0ff00U, 0xf0f0ccccU,
	0xaaaaff00U, 0xccccff00U, 0xaaaaf0f0U,
	0xaaaaf0f0U, 0xff00ccccU, 0xccccf0f0U,
	0xff00aaaaU, 0xccccaaaaU, 0xff00f0f0U,
	0xff00aaaaU, 0xf0f0ccccU, 0xf0f0ff00U,
	0xccccaaaaU, 0xf0f0ff00U, 0xaaaaccccU,
	0xaaaaff00U, 0xf0f0ccccU, 0xaaaaf0f0U,
	0xccccff00U, 0xff00ccccU, 0xaaaaf0f0U,
	0xff00aaaaU, 0xccccf0f0U
};

__constant static const uint alpha_f[] = {
	0xcaf9639cU, 0x0ff0f9c0U, 0x639c0ff0U,
	0xcaf9f9c0U, 0x0ff0f9c0U, 0x639ccaf9U,
	0xf9c00ff0U, 0x639ccaf9U, 0x639c0ff0U,
	0xf9c0caf9U, 0x0ff0caf9U, 0xf9c0639cU,
	0xf9c0639cU, 0xcaf90ff0U, 0x0ff0639cU,
	0xcaf9f9c0U, 0x0ff0f9c0U, 0xcaf9639cU,
	0xcaf9f9c0U, 0x639c0ff0U, 0x639ccaf9U,
	0x0ff0f9c0U, 0x639ccaf9U, 0xf9c00ff0U,
	0xf9c0caf9U, 0x639c0ff0U, 0xf9c0639cU,
	0x0ff0caf9U, 0xcaf90ff0U, 0xf9c0639cU,
	0xcaf9f9c0U, 0x0ff0639cU
};

/*
__constant static const uint16 alpha_n[] = 
{
	(uint16)(0xff00f0f0, 0xccccaaaa, 0xf0f0cccc, 0xff00aaaa, 0xccccaaaa, 0xf0f0ff00, 0xaaaacccc, 0xf0f0ff00, 0xf0f0cccc, 0xaaaaff00, 0xccccff00, 0xaaaaf0f0, 0xaaaaf0f0, 0xff00cccc, 0xccccf0f0, 0xff00aaaa),
	(uint16)(0xccccaaaa, 0xff00f0f0, 0xff00aaaa, 0xf0f0cccc, 0xf0f0ff00, 0xccccaaaa, 0xf0f0ff00, 0xaaaacccc, 0xaaaaff00, 0xf0f0cccc, 0xaaaaf0f0, 0xccccff00, 0xff00cccc, 0xaaaaf0f0, 0xff00aaaa, 0xccccf0f0)
};

__constant static const uint16 alpha_f[] = 
{
	(uint16)(0xcaf9639c, 0x0ff0f9c0, 0x639c0ff0, 0xcaf9f9c0, 0x0ff0f9c0, 0x639ccaf9, 0xf9c00ff0, 0x639ccaf9, 0x639c0ff0, 0xf9c0caf9, 0x0ff0caf9, 0xf9c0639c, 0xf9c0639c, 0xcaf90ff0, 0x0ff0639c, 0xcaf9f9c0),
	(uint16)(0x0ff0f9c0, 0xcaf9639c, 0xcaf9f9c0, 0x639c0ff0, 0x639ccaf9, 0x0ff0f9c0, 0x639ccaf9, 0xf9c00ff0, 0xf9c0caf9, 0x639c0ff0, 0xf9c0639c, 0x0ff0caf9, 0xcaf90ff0, 0xf9c0639c, 0xcaf9f9c0, 0x0ff0639c)
};
*/

#define HAMSI_L(a, b, c, d)   do { \
    (a) = rotate(a, 13U); \
    (c) = rotate(c, 3U); \
    (b) ^= (a) ^ (c); \
    (d) ^= (c) ^ ((a) << 3); \
    (b) = rotate(b, 1U); \
    (d) = rotate(d, 7U); \
    (a) ^= (b) ^ (d); \
    (c) ^= (d) ^ ((b) << 7); \
    (a) = rotate(a, 5U); \
    (c) = rotate(c, 22U); \
  } while (0)

//#define HAMSI_L(a, b, c, d)	do { \
	(a) = rotate((a), 13U); \
	(c) = rotate((c), 3U); \
	(b) = rotate((b) ^ (a) ^ (c), 1U); \
	(d) = rotate((d) ^ (c) ^ ((a) << 3), 7U); \
	(a) = rotate((a) ^ (b) ^ (d), 5U); \
	(c) = rotate((c) ^ (d) ^ ((b) << 7), 22U); \
} while(0)

#define SBOX_V(a, b, c, d)   do { \
    uint8 t; \
    t = (a); \
    (a) = ((a) & (c)) ^ (d); \
    (c) = (c) ^ (b) ^ (a); \
    (d) = ((d) | t) ^ (b); \
    t ^= (c); \
    (b) = (d); \
    (d) = ((d) | t) ^ (a); \
    (a) &= (b); \
    t ^= (a); \
    (b) = (b) ^ (d) ^ t; \
    (a) = (c); \
    (c) = (b); \
    (b) = (d); \
    (d) = (~t); \
  } while (0)

uint16 HamsiRound(uint16 m, uint16 h, const uint __constant *alpha, uint rnds)
{
	uint16 state0, state1;
	
	state0 = shuffle2(m.lo, h.lo, (uint16)(0, 1, 8, 9, 2, 3, 10, 11, 12, 13, 4, 5, 14, 15, 6, 7));
	state1 = shuffle2(m.hi, h.hi, (uint16)(0, 1, 8, 9, 2, 3, 10, 11, 12, 13, 4, 5, 14, 15, 6, 7));
	
	#pragma unroll
	for(int x = 0; x < rnds; ++x)
	{	
		state0.s1 ^= (uint)(x);
		state0 ^= ((__constant uint16 *)alpha)[0];
		state1 ^= ((__constant uint16 *)alpha)[1];
				
		SBOX_V(state0.lo, state0.hi, state1.lo, state1.hi);
		
		HAMSI_L(state0.s0, state0.s9, state1.s2, state1.sB);
		HAMSI_L(state0.s1, state0.sA, state1.s3, state1.sC);
		HAMSI_L(state0.s2, state0.sB, state1.s4, state1.sD);
		HAMSI_L(state0.s3, state0.sC, state1.s5, state1.sE);
		HAMSI_L(state0.s4, state0.sD, state1.s6, state1.sF);
		HAMSI_L(state0.s5, state0.sE, state1.s7, state1.s8);
		HAMSI_L(state0.s6, state0.sF, state1.s0, state1.s9);
		HAMSI_L(state0.s7, state0.s8, state1.s1, state1.sA);
		HAMSI_L(state0.s0, state0.s2, state0.s5, state0.s7);
		HAMSI_L(state1.s0, state1.s3, state1.s5, state1.s6);
		HAMSI_L(state0.s9, state0.sB, state0.sC, state0.sE);
		HAMSI_L(state1.s9, state1.sA, state1.sC, state1.sF);
	}
	
	return(h ^ (uint16)(state0.lo, state1.lo));
}

#endif
